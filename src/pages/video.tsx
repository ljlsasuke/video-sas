import { useEffect, useRef } from 'react'
import { useParams } from 'umi'
import videojs from 'video.js'
import 'video.js/dist/video-js.css'

export default function video() {
  const param = useParams()
  const videoRef = useRef(null)

  useEffect(() => {
    if (videoRef.current) {
      const player = videojs(videoRef.current, {
        controls: true,
        fluid: false,
      })

      return () => player.dispose()
    }
  }, [])

  return (
    <div className="flex h-full">
      {/* 左侧视频播放区域 */}
      <div className="h-svh min-h-[600px] min-w-[700px] flex-1 flex-col">
        <h1 className="mb-3 text-xl font-medium">
          难道天空在流眼泪吗？太阳温暖天边彩霞
        </h1>
        <h2>
          <div className="flex text-sm text-gray-400">
            <svg
              className="fill-gray-400"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              width="20"
              height="20"
            >
              <path
                d="M10 4.040041666666666C7.897383333333334 4.040041666666666 6.061606666666667 4.147 4.765636666666667 4.252088333333334C3.806826666666667 4.32984 3.061106666666667 5.0637316666666665 2.9755000000000003 6.015921666666667C2.8803183333333333 7.074671666666667 2.791666666666667 8.471183333333332 2.791666666666667 9.998333333333333C2.791666666666667 11.525566666666668 2.8803183333333333 12.922083333333333 2.9755000000000003 13.9808C3.061106666666667 14.932983333333334 3.806826666666667 15.666916666666667 4.765636666666667 15.744683333333336C6.061611666666668 15.849716666666666 7.897383333333334 15.956666666666667 10 15.956666666666667C12.10285 15.956666666666667 13.93871666666667 15.849716666666666 15.234766666666667 15.74461666666667C16.193416666666668 15.66685 16.939000000000004 14.933216666666667 17.024583333333336 13.981216666666668C17.11975 12.922916666666667 17.208333333333332 11.526666666666666 17.208333333333332 9.998333333333333C17.208333333333332 8.470083333333333 17.11975 7.073818333333334 17.024583333333336 6.015513333333334C16.939000000000004 5.063538333333333 16.193416666666668 4.329865000000001 15.234766666666667 4.252118333333334C13.93871666666667 4.147016666666667 12.10285 4.040041666666666 10 4.040041666666666zM4.684808333333334 3.255365C6.001155 3.14862 7.864583333333334 3.0400416666666668 10 3.0400416666666668C12.13565 3.0400416666666668 13.999199999999998 3.148636666666667 15.315566666666667 3.2553900000000002C16.753416666666666 3.3720016666666672 17.890833333333333 4.483195 18.020583333333335 5.925965000000001C18.11766666666667 7.005906666666667 18.208333333333336 8.433 18.208333333333336 9.998333333333333C18.208333333333336 11.56375 18.11766666666667 12.990833333333335 18.020583333333335 14.0708C17.890833333333333 15.513533333333331 16.753416666666666 16.624733333333335 15.315566666666667 16.74138333333333C13.999199999999998 16.848116666666666 12.13565 16.95666666666667 10 16.95666666666667C7.864583333333334 16.95666666666667 6.001155 16.848116666666666 4.684808333333334 16.7414C3.2467266666666665 16.624750000000002 2.1092383333333338 15.513266666666667 1.9795200000000002 14.070383333333334C1.8823900000000002 12.990000000000002 1.7916666666666667 11.562683333333334 1.7916666666666667 9.998333333333333C1.7916666666666667 8.434066666666666 1.8823900000000002 7.00672 1.9795200000000002 5.926381666666667C2.1092383333333338 4.483463333333334 3.2467266666666665 3.371976666666667 4.684808333333334 3.255365z"
                fill="currentColor"
              ></path>
              <path
                d="M12.23275 9.1962C12.851516666666667 9.553483333333332 12.851516666666667 10.44665 12.232683333333332 10.803866666666666L9.57975 12.335600000000001C8.960983333333335 12.692816666666667 8.1875 12.246250000000002 8.187503333333334 11.531733333333333L8.187503333333334 8.4684C8.187503333333334 7.753871666666667 8.960983333333335 7.307296666666667 9.57975 7.66456L12.23275 9.1962z"
                fill="currentColor"
              ></path>
            </svg>
            <span className="ml-1 mr-3">29万</span>
            <span>2024-08-06 14:49:25</span>
          </div>
        </h2>
        <div className="mb-3 h-4/5 w-full">
          <div data-vjs-player>
            <video
              ref={videoRef}
              className="video-js vjs-default-skin h-full w-full"
              controls
            >
              <source src="/test/video1.mp4" type="video/mp4" />
            </video>
          </div>
        </div>
        <div>
          {['charmmy', '梦境', '茶米', '夏日桃子'].map((tag) => (
            <a
              key={tag}
              className="mr-1 inline-block cursor-pointer rounded-lg border border-gray-300 px-2 py-1 text-base font-normal text-primary hover:bg-primary hover:text-white"
            >
              {tag}
            </a>
          ))}
        </div>
      </div>

      {/* 右侧信息区域 */}
      <div className="flex w-1/3 min-w-[300px] flex-shrink-0 flex-col border-l">
        {/* 上传者信息 */}
        <div className="border-b p-4">
          <div className="flex items-center space-x-3">
            <img
              src="/fakerAvatar.png"
              className="h-12 w-12 rounded-full"
              alt="上传者头像"
            />
            <div>
              <h3 className="text-primary">里里</h3>
              <p className="text-sm text-gray-500">希望你也天天开心！</p>
            </div>
          </div>
        </div>

        {/* 推荐视频列表 */}
        <div className="flex-1 space-y-4 overflow-y-auto p-4">
          {[1, 2, 3, 4, 5, 6, 7].map((item) => (
            <div
              key={item}
              className="flex cursor-pointer space-x-3 rounded p-2 hover:bg-gray-100"
            >
              <div className="h-20 w-32 rounded bg-gray-300"></div>
              <div>
                <h4 className="line-clamp-2 font-medium">
                  推荐视频标题 {item}
                </h4>
                <p className="text-sm text-gray-500">播放量：{item * 1000}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  )
}
